<!-- continuous form -->
<form *ngIf="(typeHint.ec || typeHint.nc)">

  <div class="form-group row">
    <label class="col-4 col-form-label"
           for="{{typeHint.ec ? 'ec' : 'nc'}}CssProperty">{{'MAIN_MAPPINGS_NEW_CSS_PROPERTY_LABEL' | translate}}</label>
    <div class="col-6">
      <input (input)="emitStyleProperty()" [(ngModel)]="styleProperty" [readOnly]="isEdit" class="form-control"
             id="{{typeHint.ec ? 'ec' : 'nc'}}CssProperty"
             name="cCssProperty" type="text">
      <small class="form-text text-muted">{{'MAIN_MAPPINGS_NEW_CSS_HINT' | translate}}</small>
    </div>
    <div class="col-2 form-check">
      <input (click)="toggleNeedsColorValidation(!needsColorValidation(styleProperty))"
             [checked]="needsColorValidation(styleProperty)"
             [disabled]="isEdit" class="form-check-input"
             id="{{typeHint.ec ? 'ec' : 'nc'}}ColorValidation"
             type="checkbox">
      <label class="form-check-label" for="{{typeHint.ec ? 'ec' : 'nc'}}ColorValidation">
        {{'MAIN_MAPPINGS_NEW_CB_COLORS' | translate}}
      </label>
    </div>
  </div>

  <!-- default lower -->
  <div class="form-group row">
    <label class="col-4 col-form-label"
           for="{{typeHint.ec ? 'ec' : 'nc'}}DefaultLower">{{'MAIN_MAPPINGS_NEW_DEFAULT_LOW' | translate}}</label>
    <div class="col-8">
      <input [(ngModel)]="thresholds[0].propertyValue" [disabled]="true"
             class="form-control"
             id="{{typeHint.ec ? 'ec' : 'nc'}}DefaultLower"
             name="{{typeHint.ec ? 'ec' : 'nc'}}DefaultLower"
             type="text"
             value="{{'MAIN_MAPPINGS_NEW_PLACEHOLDER' | translate}}">
    </div>
  </div>

  <!-- thresholds -->
  <div *ngFor="let threshold of thresholds; let index = index" class="form-group row">
    <div class="col-4">
      <input [(ngModel)]="threshold.value"
             [disabled]="!threshold.isEditable"
             class="form-control"
             id="{{typeHint.ec ? 'ec' : 'nc'}}Threshold{{index}}"
             name="{{typeHint.ec ? 'ec' : 'nc'}}Threshold{{index}}"
             type="number"
             value="">
    </div>
    <div class="col-7">
      <input *ngIf="!needsColorValidation(styleProperty)" [(ngModel)]="threshold.propertyValue"
             class="form-control"
             id="{{typeHint.ec ? 'ec' : 'nc'}}Value{{index}}"
             name="{{typeHint.ec ? 'ec' : 'nc'}}Value{{index}}"
             type="number">
      <input *ngIf="needsColorValidation(styleProperty)" [(ngModel)]="threshold.propertyValue"
             class="form-control form-control-color"
             id="colorContinuous{{index}}"
             name="colorContinuous{{index}}"
             type="color"
             value="{{threshold.propertyValue}}">
    </div>

    <div class="col-1">
      <button (click)="removeThreshold(index)"
              [disabled]="!threshold.isEditable"
              class="btn btn-outline-danger">
        <fa-icon [icon]="faTrash"></fa-icon>
      </button>
    </div>
  </div>

  <!-- button to add more thresholds -->
  <div class="form-group row">
    <div class="col-12">
      <button (click)="addNewThreshold()"
              class="btn btn-block btn-outline-info">
        <fa-icon [icon]="faPlus"></fa-icon>
      </button>
    </div>
  </div>

  <!-- default greater -->
  <div class="form-group row">
    <label class="col-4 col-form-label"
           for="{{typeHint.ec ? 'ec' : 'nc'}}DefaultGreater">{{'MAIN_MAPPINGS_NEW_DEFAULT_GREAT' | translate}}</label>
    <div class="col-8">
      <input [(ngModel)]="thresholds[1].propertyValue" [disabled]="true"
             class="form-control"
             id="{{typeHint.ec ? 'ec' : 'nc'}}DefaultGreater"
             name="{{typeHint.ec ? 'ec' : 'nc'}}DefaultGreater"
             type="text"
             value="{{'MAIN_MAPPINGS_NEW_PLACEHOLDER' | translate}}">
    </div>
  </div>

  <!-- SUBMIT/CLEAR/ABORT -->
  <div class="row">
    <div class="col-4">
      <!-- abort -->
      <button [routerLink]="['', { outlets: {primary: ['graph', dataService.selectedNetwork.id ]} }]"
              class="btn btn-block btn-outline-danger"
              data-toggle="tooltip" ngbTooltip="{{'MAIN_MAPPINGS_NEW_ABORT' | translate}}"
              placement="top"
              type="button">
        <fa-icon [icon]="faTimes"></fa-icon>
      </button>
    </div>
    <div class="col-4">
      <!-- clear -->
      <button (click)="clearAllInputs()" class="btn btn-block btn-outline-warning"
              data-toggle="tooltip" ngbTooltip="{{'MAIN_MAPPINGS_NEW_CLEAR' | translate}}"
              placement="top"
              type="button">
        <fa-icon [icon]="faUndo"></fa-icon>
      </button>
    </div>
    <div class="col-4">
      <!-- submit: new -->
      <button
        (click)="submitNewMapping()"
        *ngIf="!isEdit" [disabled]="alreadyExists"
        [routerLink]="['', { outlets: {primary: ['mappings', mapType + (getNextIdForMappingType()) ]} }]" class="btn btn-block btn-outline-success"
        data-toggle="tooltip"
        ngbTooltip="{{'MAIN_MAPPINGS_NEW_SUBMIT' | translate}}"
        placement="top"
        type="button">
        <fa-icon [icon]="faCheck"></fa-icon>
      </button>

      <!-- todo submit: edit -->
      <button (click)="editMapping()" *ngIf="isEdit"
              [routerLink]="['', { outlets: {primary: ['mappings', mapType + (dataService.countMappingsByHint(mapType) - 1) ]} }]"
              class="btn btn-block btn-outline-success" data-toggle="tooltip"
              ngbTooltip="{{'MAIN_MAPPINGS_NEW_SUBMIT' | translate}}"
              placement="top"
              type="button">
        <fa-icon [icon]="faCheck"></fa-icon>
      </button>
    </div>
  </div>
</form>

<!-- discrete form -->
<form *ngIf="(typeHint.nd || typeHint.ed)">
  <div class="form-group row">

    <label class="col-3 col-form-label"
           for="{{mapType}}CssProperty">{{'MAIN_MAPPINGS_NEW_CSS_PROPERTY_LABEL' | translate}}</label>

    <div [ngClass]="!needsFontFaceSpecificForm(styleProperty) ? 'col-7' : 'col-9'">
      <input (input)="emitStyleProperty()" [(ngModel)]="styleProperty"
             [readOnly]="isEdit" class="form-control"
             id="{{mapType}}CssProperty"
             name="{{mapType}}CssProperty" type="text">
      <small class="form-text text-muted">{{'MAIN_MAPPINGS_NEW_CSS_HINT' | translate}}</small>
      <small *ngIf="needsColorValidation(styleProperty)"
             class="form-text text-muted">{{'MAIN_MAPPINGS_NEW_COLOR_SELECTION' | translate}}</small>
    </div>

    <div *ngIf="!needsFontFaceSpecificForm(styleProperty)" class="col-2 form-check">
      <input (click)="toggleNeedsColorValidation(!needsColorValidation(styleProperty))"
             [checked]="needsColorValidation(styleProperty)"
             [disabled]="isEdit" class="form-check-input"
             id="{{mapType}}ColorValidation"
             type="checkbox">
      <label class="form-check-label" for="{{mapType}}ColorValidation">
        {{'MAIN_MAPPINGS_NEW_CB_COLORS' | translate}}
      </label>
    </div>

  </div>

  <hr>

  <!-- values and input fields for each value -->
  <div *ngFor="let entry of propertyToMap.values; let index = index" class="form-group">

    <!-- REGULAR form -->
    <div *ngIf="!needsFontFaceSpecificForm(styleProperty)">
      <div class="row">

        <label class="col-3 col-form-label" for="{{typeHint.ed ? 'ed' : 'nd'}}{{index}}">{{entry}}</label>

        <div [ngClass]="needsColorValidation(styleProperty) ? 'col-8' : 'col-9'">
          <input *ngIf="!needsColorValidation(styleProperty)"
                 [(ngModel)]="mappingDiscrete.values[getIndexByKey(entry)]"
                 class="form-control"
                 id="{{typeHint.ed ? 'ed' : 'nd'}}{{index}}"
                 name="{{typeHint.ed ? 'ed' : 'nd'}}{{index}}"
                 type="text"
                 value="{{'MAIN_MAPPINGS_NEW_PLACEHOLDER' | translate}}">
          <input *ngIf="needsColorValidation(styleProperty)"
                 [(ngModel)]="mappingDiscrete.values[getIndexByKey(entry)]"
                 [disabled]="!mappingDiscrete.useValue[index]"
                 class="form-control form-control-color"
                 id="colorDiscrete{{index}}"
                 name="colorDiscrete{{index}}"
                 type="color"
                 value="{{mappingDiscrete.values[getIndexByKey(entry)]}}">
        </div>
        <div *ngIf="needsColorValidation(styleProperty)" class="col-1">
          <input [(ngModel)]="mappingDiscrete.useValue[index]"
                 class="form-check-input"
                 id="useValue{{index}}"
                 name="useValue{{index}}"
                 type="checkbox">
        </div>
      </div>
    </div>

    <!-- FONT FACE form -->
    <div *ngIf="needsFontFaceSpecificForm(styleProperty)">

      <div class="row">

        <!-- label -->
        <label class="col-3 col-form-label" for="fontFaceFamily{{index}}">{{entry}}</label>

        <!-- font family -->
        <div [ngClass]="(setFonts[index] && isJavaLogicalFont(setFonts[index].family)) ? 'col-3' : 'col-6'">
          <select class="custom-select" id="fontFaceFamily{{index}}" size="5">
            <option (click)="setFont(index, null)"
                    value="null">{{'MAIN_MAPPINGS_NEW_FONT_FAMILY_RESET' | translate}}</option>
            <option (click)="setFont(index, font)"
                    *ngFor="let font of availableFonts"
                    [selected]="setFonts[index] && setFonts[index].family === font"
                    value="{{font}}">{{font}}</option>
          </select>
        </div>

        <!-- font style only java logical -->
        <div *ngIf="setFonts[index] && isJavaLogicalFont(setFonts[index].family)" class="col-3">
          <select class="custom-select" id="fontFaceStyle{{index}}" size="5">
            <option (click)="setStyle(index, null)"
                    value="null">{{'MAIN_MAPPINGS_NEW_FONT_STYLE_RESET' | translate}}</option>
            <option (click)="setStyle(index, style)"
                    *ngFor="let style of javaFontStyles"
                    [selected]="setFonts[index] && setFonts[index].style === style"
                    value="{{style}}">{{style}}</option>
          </select>
        </div>

        <!-- font size -->
        <div *ngIf="setFonts[index]" class="col-3">
          <label for="fontFaceSize{{index}}">
            <button (click)="setFonts[index].size = null"
                    [disabled]="!setFonts[index].size"
                    class="btn btn-sm btn-outline-secondary mr-1"
                    data-toggle="tooltip"
                    ngbTooltip="{{'MAIN_MAPPINGS_NEW_TT_FONT_SIZE' | translate}}"
                    placement="top">
              <fa-icon [icon]="faRedo"></fa-icon>
            </button>
            {{'MAIN_MAPPINGS_NEW_FONT_SIZE' | translate}}
          </label>
          <input [(ngModel)]="setFonts[index].size" class="form-control"
                 id="fontFaceSize{{index}}" name="fontFaceSize{{index}}"
                 type="number">
        </div>

      </div>

    </div>

  </div>

  <!-- SUBMIT/CLEAR/ABORT -->
  <div class="row">

    <div class="col-4">
      <!-- abort -->
      <button [routerLink]="['', { outlets: {primary: ['graph', dataService.selectedNetwork.id ]} }]"
              class="btn btn-block btn-outline-danger"
              data-toggle="tooltip" ngbTooltip="{{'MAIN_MAPPINGS_NEW_ABORT' | translate}}"
              placement="top"
              type="button">
        <fa-icon [icon]="faTimes"></fa-icon>
      </button>
    </div>

    <div class="col-4">
      <!-- clear -->
      <button (click)="clearAllInputs()" class="btn btn-block btn-outline-warning"
              data-toggle="tooltip" ngbTooltip="{{'MAIN_MAPPINGS_NEW_CLEAR' | translate}}"
              placement="top"
              type="button">
        <fa-icon [icon]="faUndo"></fa-icon>
      </button>
    </div>

    <div class="col-4">
      <!-- submit: new -->
      <button (click)="submitNewMapping()" *ngIf="!isEdit && mapType.endsWith('d')"
              [disabled]="alreadyExists"
              [routerLink]="['', { outlets: {primary: ['mappings', mapType, mappingDiscrete.col ]} }]" class="btn btn-block btn-outline-success"
              data-toggle="tooltip"
              ngbTooltip="{{'MAIN_MAPPINGS_NEW_SUBMIT' | translate}}"
              placement="top"
              type="button">
        <fa-icon [icon]="faCheck"></fa-icon>
      </button>
      <!-- submit: edit -->
      <button (click)="editMapping()" *ngIf="isEdit"
              [routerLink]="['', { outlets: {primary: ['mappings', mapType, mappingDiscrete.col ]} }]"
              class="btn btn-block btn-outline-success" data-toggle="tooltip"
              ngbTooltip="{{'MAIN_MAPPINGS_NEW_SUBMIT' | translate}}"
              placement="top"
              type="button">
        <fa-icon [icon]="faCheck"></fa-icon>
      </button>
    </div>

  </div>

</form>

<!-- passthrough form -->
<form *ngIf="(typeHint.np || typeHint.ep)">
  <div class="form-group row">
    <label class="col-4 col-form-label"
           for="{{typeHint.ep ? 'ep' : 'np'}}CssProperty">{{'MAIN_MAPPINGS_NEW_CSS_PROPERTY_LABEL' | translate}}</label>
    <div class="col-6">
      <input (input)="emitStyleProperty()" [(ngModel)]="styleProperty"
             [readOnly]="isEdit" class="form-control"
             id="{{typeHint.ep ? 'ep' : 'np'}}CssProperty"
             name="{{typeHint.ep ? 'ep' : 'np'}}CssProperty" type="text">
      <small class="form-text text-muted">{{'MAIN_MAPPINGS_NEW_CSS_HINT' | translate}}</small>
    </div>

  </div>

  <hr>

  <!-- SUBMIT/CLEAR/ABORT -->
  <div class="row">
    <div class="col-4">
      <!-- abort -->
      <button [routerLink]="['', { outlets: {primary: ['graph', dataService.selectedNetwork.id ]} }]"
              class="btn btn-block btn-outline-danger"
              data-toggle="tooltip" ngbTooltip="{{'MAIN_MAPPINGS_NEW_ABORT' | translate}}"
              placement="top"
              type="button">
        <fa-icon [icon]="faTimes"></fa-icon>
      </button>
    </div>

    <div class="col-4">
      <!-- clear -->
      <button (click)="clearAllInputs()" class="btn btn-block btn-outline-warning"
              data-toggle="tooltip" ngbTooltip="{{'MAIN_MAPPINGS_NEW_CLEAR' | translate}}"
              placement="top"
              type="button">
        <fa-icon [icon]="faUndo"></fa-icon>
      </button>
    </div>

    <div class="col-4">
      <!-- submit -->
      <button (click)="submitNewMapping()" *ngIf="!isEdit && mapType.endsWith('p')"
              [disabled]="alreadyExists"
              [routerLink]="['', { outlets: {primary: ['mappings', mapType + getNextIdForMappingType() ]} }]" class="btn btn-block btn-outline-success"
              data-toggle="tooltip"
              ngbTooltip="{{'MAIN_MAPPINGS_NEW_SUBMIT' | translate}}"
              placement="top"
              type="button">
        <fa-icon [icon]="faCheck"></fa-icon>
      </button>
    </div>

    <!-- NO EDIT FOR PASSTHROUGH -->
  </div>

</form>

